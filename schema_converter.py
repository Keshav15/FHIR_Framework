import json
from pyspark.sql.types import StructType
from pyspark.sql.types import *


schema = StructType([StructField('communication', ArrayType(StructType([StructField('coding', ArrayType(StructType([StructField('code', StringType(), True), StructField('display', StringType(), True), StructField('system', StringType(), True)]), True), True)]), True), True), StructField('extension', ArrayType(StructType([StructField('extension', ArrayType(StructType([StructField('url', StringType(), True), StructField('valueCodeableConcept', StructType([StructField('coding', ArrayType(StructType([StructField('code', StringType(), True)]), True), True)]), True), StructField('valuePeriod', StructType([StructField('end', StringType(), True), StructField('start', StringType(), True)]), True), StructField('valueReference', StructType([StructField('reference', StringType(), True)]), True)]), True), True), StructField('url', StringType(), True)]), True), True), StructField('gender', StringType(), True), StructField('id', StringType(), True), StructField('identifier', ArrayType(StructType([StructField('period', StructType([StructField('end', StringType(), True), StructField('start', StringType(), True)]), True), StructField('system',StringType(),True), StructField('type', StructType([StructField('coding', ArrayType(StructType([StructField('code', StringType(), True), StructField('display', StringType(), True), StructField('system', StringType(), True)]), True), True)]), True), StructField('value', StringType(), True)]), True), True), StructField('meta', StructType([StructField('lastUpdated', StringType(), True), StructField('profile', ArrayType(StringType(), True), True), StructField('source', StringType(), True), StructField('versionId', StringType(), True)]), True), StructField('name', ArrayType(StructType([StructField('extension', ArrayType(StructType([StructField('url', StringType(), True), StructField('valueString', StringType(), True)]), True), True), StructField('family', StringType(), True), StructField('given', ArrayType(StringType(), True), True), StructField('prefix', ArrayType(StringType(), True), True), StructField('suffix', ArrayType(StringType(), True), True)]), True), True), StructField('qualification', ArrayType(StructType([StructField('code', StructType([StructField('coding', ArrayType(StructType([StructField('code', StringType(), True), StructField('display', StringType(), True), StructField('system', StringType(), True)]), True), True), StructField('extension', ArrayType(StructType([StructField('extension', ArrayType(StructType([StructField('url', StringType(), True), StructField('valueCode', StringType(), True), StructField('valueCodeableConcept', StructType([StructField('coding', ArrayType(StructType([StructField('code', StringType(), True), StructField('display', StringType(), True), StructField('system', StringType(), True)]), True), True)]), True)]), True), True), StructField('url', StringType(), True), StructField('valueBoolean', BooleanType(), True)]), True), True)]), True), StructField('extension', ArrayType(StructType([StructField('url', StringType(), True), StructField('valueCode', StringType(), True)]), True), True), StructField('identifier', ArrayType(StructType([StructField('value', StringType(), True)]), True), True), StructField('issuer', StructType([StructField('reference', StringType(), True)]), True), StructField('period', StructType([StructField('end', StringType(), True)]), True)]), True), True), StructField('resourceType', StringType(), True), StructField('telecom', ArrayType(StructType([StructField('system', StringType(), True), StructField('use', StringType(), True), StructField('value', StringType(), True)]), True), True), StructField('text', StructType([StructField('div', StringType(), True), StructField('status', StringType(), True)]), True)])
json_schema = json.dumps(schema.jsonValue(), indent=2)

print(json_schema)

# targetschemadict={"1":["resourceType", "id", "meta.versionId", "meta.lastUpdated", "meta.profile","meta.Features","meta.healthdata","extension"],'2':["new_extension.url","new_extension.valueCodeableConcept.coding"]}
# explodedict={"1":["profile","Features","healthdata","extension"],"2":["coding"]}  

# json_object = json.dumps(schema, indent = 4) 
# print(json_object)





